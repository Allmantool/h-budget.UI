name: Upgrade NPM packages

on:
    push:
        branches: ['**']

    pull_request:
        # The branches below must be a subset of the branches above
        branches: [master]

    schedule:
        - cron: '0 0 * * *'

jobs:
    upgrade-packages:
        name: Upgrade packages job

        runs-on: ubuntu-latest

        steps:
            - name: Checkout 🛎️
              uses: actions/checkout@v3

            - name: Set up Node.js ⚙️
              uses: actions/setup-node@v3
              with:
                  node-version: '18.x'

            - name: Check and update packages 🔀
              run: |
                  npx npm-check-updates --upgrade --peer --target minor
                  npm i

            - name: Commit and create PR 🔀
              uses: peter-evans/create-pull-request@v5
              with:
                  title: 'build(deps): Upgrade NPM packages (automated)'
                  branch: 'build-deps-upgrade-npm-packages-automated'
                  commit-message: 'build(deps): upgrade NPM packages (automated)'
